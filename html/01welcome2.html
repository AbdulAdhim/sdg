<!doctype html>
<html lang="en">

<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
    integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
  <link rel="stylesheet" href="../css/style_wlc.css">


  <title>SDG Game: Welcome!</title>
  <script src="../js/main.js" type='text/javascript'></script>

  <script src="http://localhost:3000/socket.io/socket.io.js"></script>
  <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
  <!-- <script src="../js/invest.js"></script> -->

  <script>
    const token = 'fakeAuthToken-sendLoginRequestToGet';
    var socket = io(
      'http://localhost:3000', {
        query: {
          token
        }
      }
    );

    socket.on('eventOccur', function (event) {     //uniqe starter points for each players
        console.log('EVENT', event);
    });

    function createRoom() {
      socket.emit('createNewRoom');
      console.log('room created');
    }
    var roomCode;

    function joinRoom() {
      roomCode = document.getElementById("room").value;
      console.log(roomCode);
      console.log('clicked join ' + roomCode);
      socket.emit('joinRoom', roomCode);
    }

    function leaveRoom() {
      console.log("leaving room " + roomCode);
      socket.emit('leaveRoom');
    }

    function ready() {
      console.log("ready to join " + roomCode);
      socket.emit('ready');
    }

    function notReady() {
      console.log("cancelling join " + roomCode);
      socket.emit('notReady');
    }

    socket.on('roomStat', function (roomStat) { //uniqe starter points for each players
      console.log(`GAME ${roomStat.code} STATUS at ${new Date()}`)
      roomStat.gameStatus.forEach(userStat => {
        console.log(`id: ${userStat.user.id}, name: ${userStat.user.name}`)
        console.log(`.... money: ${userStat.status.money}, income: ${userStat.status.income}`)
        console.log(`.... society: ${userStat.status.society}, environment: ${userStat.status.environment}`)
        console.log(`.... society: ${userStat.status.economy}, invested: ${userStat.status.invested}`)
      });
      console.log(roomStat)
    });

    function toggler(divId) {
      $("#" + divId).toggle();
    }

    function createRoomBtn() {
      toggler('myContent');
      createRoom();
    }
  </script>

</head>

<body>
  <h1 class="text-center align-middle" style="margin-top: 200px;">Welcome to The SDG Game!</h1>
  <br>
  <div class="col-md-12 text-center">
    <button type="button" class="btn btn-success" onclick=pageRedirect('./02choose_sdg2.html')>Play </button> 
      <br>
      <br>
      <button type="button" class="btn btn-info" onClick=createRoomBtn()>Create room</button>
      <button type="button" class="btn btn-info" data-toggle="modal" data-target="#exampleModalCenter">Join
        Room</button>

      <!-- Modal -->
      <div class="modal fade" id="exampleModalCenter" tabindex="-1" role="dialog"
        aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="exampleModalLongTitle">Join a Room</h5>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div class="modal-body">
              <label for="fname">Room code:</label>
              <input type="text" id="room">
              <br>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-info" data-dismiss="modal" onclick=joinRoom()>Join Room</button>
            </div>
          </div>
        </div>
      </div>

      <br>
      <br>
        <div id="myContent" class='hidden'>
          <button type="button" class="btn btn-danger" onclick=ready()>Ready Join</button>
          <button type="button" class="btn btn-danger" onclick=notReady()>Cancel Join</button>
        </div>
  </div>

  <!-- Optional JavaScript -->
  <!-- jQuery first, then Popper.js, then Bootstrap JS -->
  <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
    integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous">
  </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
    integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous">
  </script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
    integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous">
  </script>
</body>

</html>
