<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

</head>

<body>
    <script src="http://localhost:3000/socket.io/socket.io.js"></script>
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="../js/invest.js"></script>

    <script>
        const token = 'fakeAuthToken-sendLoginRequestToGet';
        var socket = io(
                'http://localhost:3000', 
                {query: {token}}
            );
        
            // socket.emit('sendGlobalChatMessage', 'test_reload');

            // socket.emit('getCurrentStatus');

            // socket.on('userInfo', function (userInfo) {
            //     alert('USER INFO', userInfo)
            // });

            function invest(investId) {
                socket.emit('invest', investId);
            }

            function createRoom() {
                socket.emit('createNewRoom');
            }
            var roomCode;
            function joinRoom (){
                roomCode = document.getElementById("room").value;
                console.log(roomCode);
                console.log('clicked join ' + roomCode);
                socket.emit('joinRoom', roomCode);
            }

            function leaveRoom() {
                console.log("leaving room " + roomCode);
                socket.emit('leaveRoom');
            }

            function ready() {
                console.log("ready to join " + roomCode);
                socket.emit('ready');
            }

            function notReady() {
                console.log("cancelling join " + roomCode);
                socket.emit('notReady');
            }

            socket.on('roomStat', function (roomStat) {
                console.log(`GAME ${roomStat.code} STATUS at ${new Date()}`)
                roomStat.gameStatus.forEach(userStat => {
                    console.log(`id: ${userStat.user.id}, name: ${userStat.user.name}`)
                    console.log(`.... money: ${userStat.status.money}, income: ${userStat.status.income}`)
                    console.log(`.... society: ${userStat.status.society}, environment: ${userStat.status.environment}`)
                    console.log(`.... society: ${userStat.status.economy}, invested: ${userStat.status.invested}`)
                });
                console.log(roomStat)

                econSI = document.getElementById('econSI');
                socSI = document.getElementById('socSI');
                envSI = document.getElementById('envSI');
                moneyI = document.getElementById('moneyI');

                econSI.innerHTML = roomStat.gameStatus[0].status.economy;
                socSI.innerHTML = roomStat.gameStatus[0].status.environment;
                envSI.innerHTML = roomStat.gameStatus[0].status.society;
                moneyI.innerHTML = roomStat.gameStatus[0].status.money;
            });

    </script>

    <button> Test </button>

        <label for="fname">Room code:</label>
        <input type="text" id="room">
        <button onclick=createRoom()>Create room</button>
        <button onclick=joinRoom()>Join</button>
        <button onclick=leaveRoom()>Leave</button>
        <br>
        <button onclick=ready()>Ready</button>
        <button onclick=notReady()>Cancel</button>

        <button onclick=invest(0)>invest 1</button>
        <button onclick=invest(1)>invest 2</button>
        <button onclick=invest(2)>invest 3</button>
        <button onclick=invest(3)>invest 4</button>

        <!-- FE Testing: Show User Game Status -->
        <div>
            <p>Show Sustainable Index</p>
            <ul>
                <li>Economy: <span id='econSI'></span></li>
                <li>Society: <span id='socSI'></span></li>
                <li>Environment: <span id='envSI'></span></li>
            </ul>
            <p>Show Money</p>
            <p>Money: <span id='moneyI'></span></p>
        </div>
        
</body>

</html>
